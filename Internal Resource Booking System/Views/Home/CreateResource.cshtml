@model Resource


<h2>@ViewData["Title"]</h2>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />


@if (TempData["SuccessMessage"] != null)
{
    <div id="successMsg" class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle me-2"></i>@TempData["SuccessMessage"]
    </div>

    <script>
        setTimeout(() => {
            window.location.href = '@Url.Action("ResourceList", "Home")';
        }, 1000); // 2000 milliseconds = 1 second
    </script>
}





@if (!ViewData.ModelState.IsValid && ViewData.ModelState.Count > 0)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-circle me-2"></i>
        <ul class="mb-0">
            @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
            {
                <li>@error.ErrorMessage</li>
            }
        </ul>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}



<h2 class="mb-4 fw-bold">
    <i class="fas fa-tag text-primary me-2"></i>Add New Resource
</h2>

<div class="card shadow-sm p-4 mb-4 bg-light">
    <form asp-action="CreateResource" method="post" class="needs-validation" novalidate>
        <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

   
        <div class="mb-3">
            <label asp-for="Name" class="form-label fw-bold">
                <i class="fas fa-tag text-primary me-2"></i>Name <span class="text-danger">*</span>
            </label>
            <input asp-for="Name" class="form-control" required />
            <span asp-validation-for="Name" class="text-danger small"></span>
        </div>

 
        <div class="mb-3">
            <label asp-for="Description" class="form-label fw-bold">
                <i class="fas fa-align-left text-primary me-2"></i>Description <span class="text-danger">*</span>
            </label>
            <textarea asp-for="Description" class="form-control" rows="3" required></textarea>
            <span asp-validation-for="Description" class="text-danger small"></span>
        </div>

    
        <div class="mb-3">
            <label asp-for="Location" class="form-label fw-bold">
                <i class="fas fa-map-marker-alt text-primary me-2"></i>Location <span class="text-danger">*</span>
            </label>
            <input asp-for="Location" class="form-control" required />
            <span asp-validation-for="Location" class="text-danger small"></span>
        </div>

       
        <div class="mb-3">
            <label asp-for="Capacity" class="form-label fw-bold">
                <i class="fas fa-users text-primary me-2"></i>Capacity <span class="text-danger">*</span>
            </label>
            <input asp-for="Capacity" type="number" min="1" class="form-control" required />
            <span asp-validation-for="Capacity" class="text-danger small"></span>
        </div>


        <div class="form-check form-switch mb-4">
            <input asp-for="IsAvailable" class="form-check-input" type="checkbox" id="IsAvailable" />
            <label asp-for="IsAvailable" class="form-check-label fw-bold" for="IsAvailable">
                <i class="fas fa-check-circle text-primary me-2"></i>Available for Booking
            </label>
            <span asp-validation-for="IsAvailable" class="text-danger small"></span>
        </div>

   
        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-plus-circle me-2"></i>Add Resource
            </button>
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-2"></i>Back to List
            </a>
        </div>
    </form>
</div>


@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        (() => {
            'use strict';
            const forms = document.querySelectorAll('.needs-validation');
            Array.prototype.slice.call(forms).forEach((form) => {
                form.addEventListener('submit', (event) => {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        })();

        $(document).ready(function () {
            // =================================jQuery validation==================================
            $('#resourceForm').validate({
                rules: {
                    Name: { required: true },
                    Location: { required: true },
                    Capacity: {
                        required: true,
                        min: 1,
                        number: true
                    }
                },
                messages: {
                    Name: { required: 'Please enter a resource name.' },
                    Location: { required: 'Please enter a location.' },
                    Capacity: {
                        required: 'Please enter a capacity.',
                        min: 'Capacity must be at least 1.',
                        number: 'Please enter a valid number.'
                    }
                },
                errorPlacement: function (error, element) {
                    error.addClass('text-danger small').insertAfter(element);
                },
                highlight: function (element) {
                    $(element).addClass('is-invalid').removeClass('is-valid');
                },
                unhighlight: function (element) {
                    $(element).removeClass('is-invalid').addClass('is-valid');
                }
            });

        
            @if (Model?.IsAvailable == true)
            {
                    @:$('#IsAvailable').prop('checked', true);
            }

           

        });
    </script>
}
